# Notifications

Notification package to create and send push notifications, using [Google Firebase Cloud Messaging](https://firebase.google.com/docs/cloud-messaging)

## Package Configuration

### Firebase Setup Requirements

To initialize Firebase correctly, this package requires the following three environment variables to be configured. These values can be obtained by downloading the service account file from the Firebase Admin Console:

- FIREBASE_PRIVATE_KEY_BASE64: A Base64-encoded private key string.
- FIREBASE_PROJECT_ID: The Firebase project ID as a string.
- FIREBASE_CLIENT_EMAIL: The client email associated with the Firebase project.

Each of these environment variables must be securely stored in AWS Secrets Manager for the service that uses the notifications package.

For V1 of this project, which triggers notifications via Ender, these values must specifically be added to the Ender secrets vault in AWS.

## Mobile App Token Registration

To enable push notifications, users must register their devices by using the following endpoint:

**POST** ```v4/:address/registerToken```

**Request Payload**:  ```{ token: "<TOKEN_HASH>", language: 'en' }```

`token`: A valid push notification token generated by the Google Firebase SDK.

`language`: A string representing the user's preferred language, following the ISO 639-1 standard. This must be one of the supported languages listed below:

- 'en' (English)
- 'es' (Spanish)
- 'fr' (French)
- 'de' (German)
- 'it' (Italian)
- 'ja' (Japanese)
- 'ko' (Korean)
- 'zh' (Chinese)
